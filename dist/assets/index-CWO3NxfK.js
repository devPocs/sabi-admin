import{r as e,K as s,j as r,B as a,L as l,N as o,d as n,F as i,O as d,V as t,a as c,T as h,y as u,i as m,l as x,P as g,W as p,m as b,S as j,C as A,o as v,D as w,H as f,M as N,p as C,q as L,t as S,w as y}from"./index-fiy_3RNy.js";const k=({vendor:h,onClose:m})=>{const[x,g]=e.useState("Unblocked"),p=s("gray.900","white"),b=s("white","gray.800");if(s("#FAD3D3","#FAD3D3"),console.log("vendor id",null==h?void 0:h.id),!h)return null;return r.jsxs(a,{width:"100%",bg:b,borderRadius:"8px",p:"24px",position:"relative",children:[r.jsx(a,{position:"absolute",top:"12px",right:"12px",zIndex:"1",children:r.jsx(l,{size:"32px",bg:"rgba(230, 255, 250, 0.8)",cursor:"pointer",onClick:m,children:r.jsx(o,{size:"sm"})})}),r.jsx(n,{size:"lg",fontWeight:"700",color:p,mb:"24px",children:"Vendor Details"}),r.jsx(i,{justifyContent:"center",alignItems:"center",mb:"24px",children:r.jsx(d,{size:"lg",name:h.name||h.businessName,src:h.profileImage,borderRadius:"full"})}),r.jsxs(t,{align:"stretch",spacing:"20px",children:[r.jsx(F,{label:"Business Name",value:h.businessName||"N/A"}),r.jsx(F,{label:"Phone Number",value:h.phoneNumber||"N/A"}),r.jsx(F,{label:"Email Address",value:h.email||"N/A"}),r.jsx(F,{label:"LGA",value:h.lga||"N/A"}),r.jsx(F,{label:"Address",value:h.address||"N/A"}),r.jsx(F,{label:"Date Added",value:h.dateAdded||"N/A"})]}),r.jsx(c,{w:"100%",mt:"32px",bg:"Unblocked"===x?"#FFF5F5":"#E8FFF5",color:"Unblocked"===x?"#E53E3E":"#38A169",fontWeight:"600",_hover:{bg:"Unblocked"===x?"#F8BEBE":"#D6F5E6"},height:"48px",borderRadius:"8px",onClick:()=>{const e="Unblocked"===x?"Blocked":"Unblocked";g(e),u.success(`User has been ${e.toLowerCase()} successfully`,{autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},children:"Unblocked"===x?"Block":"Unblock"}),r.jsx(c,{w:"100%",mt:"32px",bg:"green.500",color:"white",fontWeight:"600",_hover:{bg:"#F8BEBE"},height:"48px",borderRadius:"8px",children:"Approve Vendor"})]})},F=({label:e,value:s})=>r.jsxs(a,{children:[r.jsx(h,{fontSize:"14px",fontWeight:"600",color:"black",mb:"4px",children:e}),r.jsx(h,{fontSize:"15px",fontWeight:"400",color:"gray.700",children:s})]}),E=()=>{var s,l;const o=m(),[n,d]=e.useState(""),[t,u]=e.useState(!1),[F,E]=e.useState("all lgas"),z=x({base:!0,md:!1}),{isOpen:D,onOpen:W,onClose:G}=g(),[U,P]=e.useState(null),{data:V=[],isLoading:B}=p(),I=e.useMemo((()=>{if(!V||0===V.length)return[{name:"All LGAs",value:"all lgas"}];try{return[{name:"All LGAs",value:"all lgas"},...V.map((e=>({name:e.name,value:e.name.toLowerCase()})))]}catch(e){return console.error("Error processing LGAs:",e),[{name:"All LGAs",value:"all lgas"}]}}),[V]),{data:R,isLoading:M,isError:O}=b({queryKey:["vendors"],queryFn:y.getVendorAndProducts,onError:e=>{var s;o({title:"Error",description:(null==(s=null==e?void 0:e.data)?void 0:s.message)||"Failed to fetch vendors",status:"error",duration:5e3,isClosable:!0})}}),q=(null==(l=null==(s=null==R?void 0:R.data)?void 0:s.pageItems)?void 0:l.map(((e,s)=>({"S/N":s+1,Vendor:e.name||e.vendorName||"N/A",LGA:e.lga||"N/A","Phone Number":e.phoneNumber||"N/A",id:e.id||s,email:e.email||"N/A",address:e.address||"N/A",dateAdded:e.dateAdded||(new Date).toISOString(),profileImage:e.profileImage||"",userAddress:e.address||"N/A"}))))||[],H=()=>t&&n.trim()||"all lgas"!==F?q.filter((e=>{const s=!t||!n.trim()||e.Vendor.toLowerCase().includes(n.toLowerCase())||e["Phone Number"].toLowerCase().includes(n.toLowerCase()),r="all lgas"===F||e.LGA.toLowerCase()===F.toLowerCase();return s&&r})):q,$=[{field:"S/N",headerName:"S/N",width:70,disableColumnMenu:!0,flex:z?0:.5,minWidth:50},{field:"Vendor",headerName:"Vendor",width:200,disableColumnMenu:!0,flex:z?0:1.5,minWidth:120},{field:"LGA",headerName:"LGA",width:150,disableColumnMenu:!0,flex:z?0:1,minWidth:80},{field:"Phone Number",headerName:"Phone Number",width:150,disableColumnMenu:!0,flex:z?0:1,minWidth:120}],K=e=>{try{const s=new Date(e);return`${s.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}; ${s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}).toLowerCase()}`}catch(s){return e}};return r.jsxs(a,{w:"100%",children:[r.jsx(a,{display:"flex",mt:[3,4,5],mb:[4,5,6],justifyContent:"space-between",children:r.jsx(h,{fontWeight:"bold",fontSize:["md","lg"],color:"black",children:"Vendors List"})}),r.jsx(i,{mt:[4,5,6],mb:[4,5,6],children:r.jsx(a,{w:"100%",h:"40px",maxW:["100%","100%","320px"],children:r.jsx(j,{placeHolder:"Search for a vendor",showSelect:!0,selectMenu:B?[{name:"All LGAs",value:"all lgas"}]:I,onSearch:e=>{d(e),u(!0)},onSelectChange:e=>{E(e)}})})}),r.jsxs(a,{mt:["10px","16px","24px"],overflowX:"auto",children:[M?r.jsx(A,{py:10,children:r.jsx(v,{})}):O?r.jsx(A,{py:10,children:r.jsx(h,{color:"red.500",children:"Error loading vendors. Please try again."})}):0===H().length?r.jsx(A,{py:10,children:r.jsx(h,{children:t&&""!==n.trim()?"No vendors match your search criteria.":"No vendors found."})}):r.jsx(w,{onRowClick:e=>{console.log(e);const s={id:e.row.id,businessName:e.row.Vendor,phoneNumber:e.row["Phone Number"],lga:e.row.LGA,email:e.row.email,address:e.row.userAddress,dateAdded:K(e.row.dateAdded),profileImage:e.row.profileImage};P(s),W()},columns:$,rows:H()}),!M&&!O&&H().length>0&&r.jsxs(i,{justify:["center","space-between"],align:"center",mt:4,p:2,flexDirection:["column","row"],gap:[3,0],children:[r.jsx(i,{align:"center",children:r.jsx(h,{fontSize:"sm",color:"gray.600",mr:2,children:"Rows per page: 10"})}),r.jsxs(f,{spacing:1,children:[r.jsx(c,{variant:"ghost",size:"sm",isDisabled:!0,children:"‹"}),r.jsx(c,{size:"sm",colorScheme:"teal",variant:"solid",borderRadius:"md",children:"1"}),r.jsx(c,{variant:"ghost",size:"sm",children:"2"}),r.jsx(c,{variant:"ghost",size:"sm",children:"›"})]})]})]}),r.jsxs(N,{isOpen:D,onClose:G,isCentered:!0,size:"md",children:[r.jsx(C,{backdropFilter:"blur(5px)"}),r.jsx(L,{borderRadius:"12px",maxW:["90%","450px"],children:r.jsx(S,{p:0,children:r.jsx(k,{vendor:U,onClose:G})})})]})]})};export{E as default};
