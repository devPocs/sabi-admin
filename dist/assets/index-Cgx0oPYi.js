import{c as e,b as s,u as r,w as a,y as l,j as i,B as n,d,e as t,f as o,g as m,I as u,h,i as c,r as x,k as b,l as p,m as g,F as j,T as f,a as N,n as S,S as v,C as w,o as y,D as C,H as A,M,p as z,q as P,s as E,t as T,A as q,v as F,x as D,z as k,E as W,G as R,J as I}from"./index-fiy_3RNy.js";const K=e().shape({fullName:s().required("Full name is required"),emailAddress:s().email("Invalid email address").required("Email address is required"),phoneNumber:s().required("Phone number is required").matches(/^[0-9]+$/,"Phone number must contain only digits").min(10,"Phone number must be at least 10 digits")}),L=({onSuccess:e})=>{const{mutate:s,isPending:c}=r({mutationFn:e=>a.addTeamMate(e),onSuccess:()=>{l.success("Team mate added successfully!"),e()},onError:e=>{l.error("Failed to add team mate"),console.error("Error adding team mate:",e)}});return i.jsxs(n,{width:"100%",children:[i.jsx(d,{fontWeight:"600",fontSize:"24px",color:"gray.700",mb:"24px",textAlign:"center",children:"Add Team Mate"}),i.jsx(t,{initialValues:{fullName:"",emailAddress:"",phoneNumber:""},validationSchema:K,onSubmit:(e,{resetForm:r})=>{const a={...e,phoneNumber:e.phoneNumber.replace(/\D/g,"")};s(a),r()},children:({errors:e,touched:s,values:r,handleChange:a})=>i.jsx(o,{style:{width:"100%"},children:i.jsxs(m,{children:[i.jsx(n,{mb:"16px",children:i.jsx(u,{showPrefix:!1,onChange:a,name:"fullName",value:r.fullName,placeholder:"Full Name",title:"Full Name",errorMsg:e.fullName,error:null!=e.fullName&&null!=s.fullName,height:"40px",fontSize:"14px"})}),i.jsx(n,{mb:"16px",children:i.jsx(u,{showPrefix:!1,onChange:a,name:"emailAddress",value:r.emailAddress,placeholder:"Email Address",title:"Email Address",errorMsg:e.emailAddress,error:null!=e.emailAddress&&null!=s.emailAddress,height:"40px",fontSize:"14px"})}),i.jsx(n,{mb:"24px",children:i.jsx(u,{showPrefix:!1,onChange:a,name:"phoneNumber",value:r.phoneNumber,placeholder:"Phone Number",title:"Phone Number",errorMsg:e.phoneNumber,error:null!=e.phoneNumber&&null!=s.phoneNumber,height:"40px",fontSize:"14px"})}),i.jsx(n,{children:i.jsx(h,{variant:"brand",isDisabled:c,label:c?"Adding...":"Add Team Mate",type:"submit",width:"100%",height:"40px"})})]})})})]})},O=e().shape({fullName:s().required("Full name is required"),emailAddress:s().email("Invalid email address").required("Email address is required"),phoneNumber:s().required("Phone number is required").matches(/^[0-9]+$/,"Phone number must contain only digits").min(10,"Phone number must be at least 10 digits")}),Q=({onSuccess:e,onClose:s,teamMateData:l})=>{const x=c(),b=r({mutationFn:e=>a.editTeamMate(e,l.id),onSuccess:r=>{x({title:"Team mate updated",description:"Team mate has been updated successfully",status:"success",duration:5e3,isClosable:!0}),s&&"function"==typeof s&&s(),e&&"function"==typeof e&&e()},onError:e=>{var s;x({title:"Error",description:(null==(s=null==e?void 0:e.data)?void 0:s.message)||"Failed to update team mate",status:"error",duration:5e3,isClosable:!0})}});return i.jsxs(n,{width:"100%",children:[i.jsx(d,{fontWeight:"600",fontSize:"24px",color:"gray.700",mb:"24px",textAlign:"center",children:"Edit Team Mate"}),i.jsx(t,{initialValues:{fullName:(null==l?void 0:l.fullName)||"",emailAddress:(null==l?void 0:l.emailAddress)||"",phoneNumber:(null==l?void 0:l.phoneNumber)||""},enableReinitialize:!0,validationSchema:O,onSubmit:e=>{const s={fullName:e.fullName,emailAddress:e.emailAddress,phoneNumber:e.phoneNumber.replace(/\D/g,"")};b.mutate(s)},children:({errors:e,touched:s,values:r,handleChange:a})=>i.jsx(o,{style:{width:"100%"},children:i.jsxs(m,{children:[i.jsx(n,{mb:"16px",children:i.jsx(u,{showPrefix:!1,onChange:a,name:"fullName",value:r.fullName,placeholder:"Full Name",title:"Full Name",errorMsg:e.fullName,error:null!=e.fullName&&null!=s.fullName,height:"40px",fontSize:"14px"})}),i.jsx(n,{mb:"16px",children:i.jsx(u,{showPrefix:!1,onChange:a,name:"emailAddress",value:r.emailAddress,placeholder:"Email Address",title:"Email Address",errorMsg:e.emailAddress,error:null!=e.emailAddress&&null!=s.emailAddress,height:"40px",fontSize:"14px"})}),i.jsx(n,{mb:"24px",children:i.jsx(u,{showPrefix:!1,onChange:a,name:"phoneNumber",value:r.phoneNumber,placeholder:"Phone Number",title:"Phone Number",errorMsg:e.phoneNumber,error:null!=e.phoneNumber&&null!=s.phoneNumber,height:"40px",fontSize:"14px"})}),i.jsx(n,{children:i.jsx(h,{variant:"brand",isDisabled:b.isPending,label:b.isPending?"Updating...":"Update Team Mate",type:"submit",width:"100%",height:"40px"})})]})})})]})},B=()=>{var e,s;const[d,t]=x.useState(!1),[o,m]=x.useState(!1),[u,h]=x.useState(!1),[c,K]=x.useState(null),[O,B]=x.useState(null),[H,U]=x.useState(""),[V,$]=x.useState(!1),_=x.useRef(null),G=b(),J=p({base:"sm",md:"md"}),X=p({base:!0,md:!1}),Y=p({base:"100%",sm:"100%",md:"320px"}),{data:Z,isPending:ee,isError:se}=g({queryKey:["teamMembers"],queryFn:()=>a.getTeamMates(),staleTime:3e5,retry:2}),re=(null==(s=null==(e=null==Z?void 0:Z.data)?void 0:e.pageItems)?void 0:s.map(((e,s)=>({"S/N":s+1,Name:e.fullName,Email:e.emailAddress,id:e.id||s,fullName:e.fullName,emailAddress:e.emailAddress,phoneNumber:e.phoneNumber}))))||[],ae=()=>{if(!V||!H.trim()||!re.length)return re;const e=H.toLowerCase();return re.filter((s=>s.fullName.toLowerCase().includes(e)||s.emailAddress.toLowerCase().includes(e)))},{mutate:le,isPending:ie}=r({mutationFn:e=>a.deleteTeamMate(e),onSuccess:()=>{l.success("Team member deleted"),G.invalidateQueries({queryKey:["teamMembers"]}),h(!1),B(null)},onError:e=>{l.error("Failed to delete team member"),console.error("Error deleting team member:",e),h(!1)}}),ne=[{field:"S/N",headerName:"S/N",width:70,disableColumnMenu:!0,flex:X?0:.5,minWidth:50},{field:"Name",headerName:"Name",width:200,disableColumnMenu:!0,flex:X?0:1,minWidth:120},{field:"Email",headerName:"Email",width:250,disableColumnMenu:!0,flex:X?0:1.5,minWidth:150},{field:"actions",headerName:"Action",width:150,disableColumnMenu:!0,align:"center",flex:X?0:.8,minWidth:100,renderCell:e=>i.jsxs(A,{spacing:3,justifyContent:"space-around",display:"flex",height:"100%",children:[i.jsx(W,{icon:i.jsx(R,{}),color:"green.500",variant:"ghost",size:J,"aria-label":"Edit",onClick:s=>{var r;s.stopPropagation(),r=e.row,K(r),m(!0)}}),i.jsx(W,{icon:i.jsx(I,{}),color:"red.500",variant:"ghost",size:J,"aria-label":"Delete",onClick:s=>{var r;s.stopPropagation(),r=e.row,B(r),h(!0)}})]})}];return i.jsxs(n,{w:"100%",children:[i.jsxs(j,{justifyContent:"space-between",alignItems:"center",mt:[3,4,5],mb:[4,5,6],flexDirection:{base:"column",sm:"row"},gap:{base:3,sm:0},children:[i.jsx(f,{fontWeight:"bold",fontSize:["md","lg"],color:"black",children:"Team Members"}),i.jsx(N,{leftIcon:i.jsx(S,{}),borderRadius:"5",colorScheme:"teal",size:J,onClick:()=>{t(!0)},children:"Add New"})]}),i.jsx(j,{mt:[4,5,6],mb:[4,5,6],children:i.jsx(n,{w:"100%",h:"40px",maxW:Y,children:i.jsx(v,{placeHolder:"Search for a member",showSelect:!1,onSearch:e=>{U(e),$(!0)}})})}),i.jsxs(n,{mt:["10px","16px","24px"],overflowX:"auto",children:[ee?i.jsx(w,{py:10,children:i.jsx(y,{})}):se?i.jsx(w,{py:10,children:i.jsx(f,{color:"red.500",children:"Error loading team members. Please try again."})}):0===ae().length?i.jsx(w,{py:10,children:i.jsx(f,{children:V&&""!==H.trim()?"No team members match your search criteria.":"No team members found. Add new team members using the button above."})}):i.jsx(C,{columns:ne,rows:ae()}),!ee&&!se&&ae().length>0&&i.jsxs(j,{justify:{base:"center",sm:"space-between"},align:"center",mt:4,p:2,flexDirection:{base:"column",sm:"row"},gap:{base:3,sm:0},children:[i.jsx(j,{align:"center",children:i.jsx(f,{fontSize:"sm",color:"gray.600",mr:2,children:"Rows per page: 10"})}),i.jsxs(A,{spacing:1,children:[i.jsx(N,{variant:"ghost",size:"sm",isDisabled:!0,children:"‹"}),i.jsx(N,{size:"sm",colorScheme:"teal",variant:"solid",borderRadius:"md",children:"1"}),i.jsx(N,{variant:"ghost",size:"sm",children:"2"}),i.jsx(N,{variant:"ghost",size:"sm",children:"›"})]})]})]}),i.jsxs(M,{isOpen:d,onClose:()=>t(!1),size:{base:"sm",md:"md"},isCentered:!0,children:[i.jsx(z,{backdropFilter:"blur(5px)"}),i.jsxs(P,{maxW:{base:"90%",md:"400px"},children:[i.jsx(E,{}),i.jsx(T,{padding:{base:"24px",md:"32px"},children:i.jsx(L,{onSuccess:()=>{t(!1),G.invalidateQueries({queryKey:["teamMembers"]})}})})]})]}),c&&i.jsxs(M,{isOpen:o,onClose:()=>m(!1),size:{base:"sm",md:"md"},isCentered:!0,children:[i.jsx(z,{backdropFilter:"blur(5px)"}),i.jsxs(P,{maxW:{base:"90%",md:"400px"},children:[i.jsx(E,{}),i.jsx(T,{padding:{base:"24px",md:"32px"},children:i.jsx(Q,{onSuccess:()=>{m(!1),G.invalidateQueries({queryKey:["teamMembers"]})},teamMateData:{...c,id:String(c.id)},onClose:()=>m(!1)})})]})]}),i.jsx(q,{isOpen:u,leastDestructiveRef:_,onClose:()=>h(!1),isCentered:!0,size:{base:"sm",md:"md"},children:i.jsx(z,{bg:"blackAlpha.300",backdropFilter:"blur(5px)",children:i.jsxs(F,{borderRadius:"md",boxShadow:"xl",mx:{base:4,md:"auto"},children:[i.jsx(D,{fontSize:"lg",fontWeight:"bold",color:"red.500",borderBottom:"1px solid",borderColor:"gray.100",pb:3,children:"Delete Team Member"}),i.jsx(T,{fontSize:"sm",children:"Are you sure you want to delete this team member? This action cannot be undone."}),i.jsxs(k,{borderTop:"1px solid",borderColor:"gray.100",pt:3,children:[i.jsx(N,{ref:_,borderRadius:"md",_hover:{color:"white",bg:"gray.700"},fontSize:"sm",variant:"outline",onClick:()=>h(!1),children:"Cancel"}),i.jsx(N,{colorScheme:"red",onClick:()=>{O&&O.id&&le(O.id)},ml:3,fontSize:"sm",isLoading:ie,borderRadius:"md",loadingText:"Deleting...",_hover:{bg:"red.600"},children:"Delete"})]})]})})})]})};export{B as default};
